<div class="ui container bangumi-account-binding-container">
    <div class="ui secondary pointing menu">
        <a routerLink="/settings/user" class="item">用户设置</a>
        <a routerLink="/settings/web-hook" class="item">Web Hook</a>
        <a routerLink="/settings/bangumi" class="active item">Bangumi 账户关联</a>
    </div>
    <div class="ui segment">
        <h4>bgm.tv 登录状态</h4>
        <div class="ui visible message">
            <div class="header">这是什么？</div>
            我们提供的同步状态至 Bangumi 的功能需要您当前的浏览器在 https://bgm.tv 登陆您的 Bangumi 账号。如您没有在此域名登陆 Bangumi 账号，请先登陆后再进行绑定操作。
        </div>
        <div class="bangumi-login-status" *ngIf="isLogin === LOGON_STATUS.UNSURE">正在检查...</div>
        <div class="bangumi-login-status" *ngIf="isLogin !== LOGON_STATUS.UNSURE">
            <i class="status-icon" [ngClass]="{'status-logon': isLogin === LOGON_STATUS.TRUE,'status-logout': isLogin === LOGON_STATUS.FALSE}"></i>
            <span class="status-text">当前登录状态：{{isLogin === LOGON_STATUS.TRUE ? '已登录': '未登录'}}</span>
            <a class="ui basic blue button" target="_blank" *ngIf="isLogin === LOGON_STATUS.FALSE" (click)="loginInBgmTv()">立即去 bgm.tv 登录</a>
        </div>
    </div>
    <div class="ui segment">
        <h4>关联 Bangumi 账户</h4>
        <div _ngcontent-c6="" class="ui visible message">
            <div _ngcontent-c6="" class="header">这是什么？</div>
            将您的账户与 Bangumi 账户关联，我们可以自动帮您同步您在 番組Collection 的收藏和观看状态至您的 Bangumi 账户，您还可以直接在番組信息页对番組打分和评价。
        </div>
        <div _ngcontent-c6="" class="ui visible message">
            <div _ngcontent-c6="" class="header">这安全么？</div>
            这十分安全：您在下方输入的 Bangumi 账户邮箱和密码，包括您的 Bangumi 用户名，都将只记录在您的 番組Collection Plus 浏览器扩展中，我们的服务器完全无法访问您的 Bangumi 账户。
        </div>
        <div class="bangumi-bound" *ngIf="!!authInfo && !isLoading">
            <div class="avatar">
                <img [src]="authInfo.avatar.large" alt="avatar">
            </div>
            <div class="info">
                <div class="nickname">{{authInfo.nickname}}</div>
                <div class="username">@{{authInfo.username}}</div>
                <a class="user-space-url" [href]="authInfo.url" target="_blank">{{authInfo.url}}</a>
                <div class="actions">
                    <button class="ui red button" type="button"
                            confirmDialog
                            dialogTitle="确定取消关联吗？"
                            dialogContent="取消关联后将失去所有 Bangumi 相关功能，包括番組详细信息获取。您可以随时重新关联您的 Bangumi 帐号。"
                            (onConfirm)="revokeAuth()">取消关联</button>
                </div>
            </div>
        </div>
        <div class="bangumi-non-bound" *ngIf="!authInfo && !isLoading">
            <form class="auth-form ui form" [formGroup]="authForm" novalidate (submit)="login($event)">
                <div class="field">
                    <label>Bangumi 邮箱</label>
                    <input type="text" placeholder="您的 Bangumi 账户邮箱" formControlName="username" autocomplete="new-username">
                </div>
                <div class="field">
                    <label>Bangumi 密码</label>
                    <input type="password" placeholder="您的 Bangumi 账户密码" formControlName="password" autocomplete="new-password">
                </div>
                <div class="footer">
                    <button class="ui primary button" type="submit">登录</button>
                </div>
            </form>
            <div class="ui active inverted dimmer" *ngIf="isAuthenticating">
                <div class="ui loader"></div>
            </div>
        </div>
    </div>
</div>